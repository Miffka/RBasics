#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "")+
scale_x_discrete(name = "Классы патогенов")+
scale_fill_discrete(name = "Класс")+
theme_calc()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы патогенов")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_calc()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий в полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_calc()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_calc()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_dark()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_economist()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_few()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_minimal()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_solarized()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_void()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_wsj()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_base()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_calc()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_bw()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03Mini)+
geom_col(width = 100,
#        position = "dodge",
aes(x = "", y = Class.count, fill = Class)
)+
#geom_col(width = 100,
#        position = "dodge",
#       aes(x = "", y = Pathogen.count, group = Class, alpha = 0.1, fill = "")
#      )+
coord_polar("y")+
scale_y_discrete(name = "Классы бактерий\nв полной выборке")+
scale_x_discrete(name = "")+
scale_fill_discrete(name = "Класс")+
theme_calc()+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen03, aes(x = PhenotypeNew))+
geom_histogram()
ggplot(myfile3phyloPhen03, aes(x = PhenotypeNew))+
stat_count()
ggplot(myfile3phyloPhen03, aes(x = as.factor(PhenotypeNew)))+
stat_count()
ggplot(myfile3phyloPhen03, aes(x = as.factor(PhenotypeNew)))+
stat_count(position = "dodge")
ggplot(myfile3phyloPhen02, aes(x = as.factor(PhenotypeNew)))+
stat_count(position = "dodge")
ggplot(myfile3phyloPhen02, aes(x = as.factor(PhenotypeNew), fill = as.factor(PhenotypeNew)))+
stat_count(position = "dodge")
ggplot(myfile3phyloPhen02, aes(x = as.factor(PhenotypeNew), fill = as.factor(PhenotypeNew)))+
stat_count()+
coord_polar("y")
ggplot(myfile3phyloPhen02, aes(x = as.factor(PhenotypeNew), fill = as.factor(PhenotypeNew)))+
stat_count(position = "stack")+
coord_polar("y")
ggplot(myfile3phyloPhen02, aes(x = as.factor(PhenotypeNew), fill = as.factor(PhenotypeNew)))+
stat_count(position = "stack")+
coord_polar("x")
ggplot(myfile3phyloPhen02, aes(x = as.factor(PhenotypeNew), fill = as.factor(PhenotypeNew)))+
stat_count()
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count()
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count()+
coord_polar()
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar()
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Распределение патогенных и непатогенных вариантов")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
#myfiles3 <- read.table("IMG_non-pathog.xls", header = T, sep = "\t", na.strings = "-", skipNul = T, )
myfile3 <- read.delim("IMG_non-pathog.xls", stringsAsFactors = F)
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
theme(axis.title = element_text(size = 20),
plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
guide_legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
#guide_legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
guide_legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining/RAnalysis2")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)+
labs(fill = "Фенотип")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
#legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)+
labs(fill = "Фенотип")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
#legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)+
scale_fill_discrete(name = "Фенотип")
ggplot(myfile3phyloPhen02, aes(x = "", fill = as.factor(PhenotypeNew)))+
stat_count(width = 100)+
coord_polar("y")+
theme_calc()+
scale_y_discrete(name = "Доля патогенов\nв выборке")+
scale_x_discrete(name = "")+
#legend(title = "Фенотип")+
theme(axis.title = element_text(size = 20),
#plot.title = element_text(size = 25),
legend.title = element_text(size = 17)
)+
scale_fill_discrete(name = "Фенотип", labels = c("Непатоген", "Патоген"))
table(myfile3phyloPhen02$PhenotypeNew)
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining")
allinfo %>%
filter(length(Phenotype) > 2) %>%
summary(n())
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(ggplot2)
library(ggthemes)
library(lazyeval)
allinfo <- read.delim("IMG_all-more+pathog.xls", stringsAsFactors = F)
nrow(allinfo)
allinfo <- read.delim("IMG_all-more+pathog.xls", stringsAsFactors = F)
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining/RAnalysis2")
allinfo <- read.delim("IMG_all-more+pathog.xls", stringsAsFactors = F)
nrow(allinfo)
length(table(allinfo$Phenotype))
allinfo %>%
filter(length(Phenotype) > 2) %>%
summary(n())
allinfo %>%
filter(length(Phenotype) > 2) %>%
table(Phenotype)
allinfo %>%
filter(length(Phenotype) > 2) %>%
table(.$Phenotype)
allinfo01 <- allinfo %>%
filter(length(Phenotype) > 2)
length(table(allinfo$Phenotype))
table(allinfo$Phenotype)
allinfo01 <- allinfo %>%
filter(length(Phenotype) > 3)
allinfo01 <- allinfo %>%
filter(nchar(Phenotype) > 2)
allinfo01 <- allinfo %>%
filter(nchar(Phenotype) > 1)
allinfo01 <- allinfo %>%
filter(nchar(Phenotype) > 0)
?mutate
?mutate_if
?contains
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining/RBasics")
?select
?contains
setwd("/media/glycosylase/EC6A2F256A2EEBD0/Documents and Settings/miffka/Documents/!DataMining/RBasics")
allinfo01 <- allinfo01 %>%
select(Phenotype) %>%
mutate_if(contains("\wPathogen\w"), Pathogen.New = "P")
?contains
allinfo01 <- allinfo01 %>%
select(Phenotype) %>%
mutate_if(contains(mathces("\wPathogen\w")), Pathogen.New = "P")
allinfo01 <- allinfo01 %>%
select(Phenotype) %>%
mutate_if(contains(matches("Pathogen")), Pathogen.New = "P")
?which
?grep
grep("Pathogen", levels(allinfo01$Phenotype), value = TRUE)
levels(allinfo01$Phenotype)
unique(allinfo01$Phenotype)
grep("Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("\wPathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("\wPathogen\w", unique(allinfo01$Phenotype), value = TRUE)
grep("[!-]Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("[-]Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("\bPathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("\BPathogen", unique(allinfo01$Phenotype), value = TRUE)
grep(" ?Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("[[:space:]]?Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("[[:space:]]+Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("Non-Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("^Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("^Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("[[:space:]Pathogen", unique(allinfo01$Phenotype), value = TRUE)
grep("[[:space:]]Pathogen", unique(allinfo01$Phenotype), value = TRUE)
unique(allinfo01$Phenotype)
